import React from "react";
import PropTypes from "prop-types";

const url = require("url");

export const withInternalLink = (InternalLinkComponent, host) => {
  class InternalLink extends React.Component {
    constructor(props) {
      super(props);
    }

    render() {
      const UniversalURL = (url && url.URL) || URL;
      const to = new UniversalURL(this.props.to);

      if (InternalLinkComponent && to.host === host && !this.props.external) {
        return (
          <InternalLinkComponent to={to.pathname}>
            {this.props.children}
          </InternalLinkComponent>
        );
      } else {
        return (
          <a href={this.props.to} target="_blank" rel="noopener noreferrer">
            {this.props.children}
          </a>
        );
      }
    }
  }

  InternalLink.propTypes = {
    to: PropTypes.string,
    external: PropTypes.bool,
    children: PropTypes.node,
  };

  return InternalLink;
};
