{"ast":null,"code":"import _objectSpread from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _styled2 from \"styled-components\";\nimport _styled from \"styled-components\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport debounce from 'lodash.debounce';\nimport React, { memo, useEffect, useState, useRef, useMemo, Fragment } from 'react';\nimport styled from 'styled-components';\nimport { ReactComponent as Plus } from \"@svgr/webpack?-svgo,+titleProp,+ref!../images/plus.svg\";\nimport { Flex, Text, Box } from '@makerdao/ui-components-core';\nimport RatioDisplay from './RatioDisplay';\nimport { Link, useCurrentRoute } from 'react-navi';\nimport useModal from 'hooks/useModal';\nimport useMaker from 'hooks/useMaker';\nimport useAnalytics from 'hooks/useAnalytics';\nimport { Routes } from '../utils/constants';\nimport { getMeasurement } from '../styles/theme';\nimport lang from 'languages';\nimport useVaults from 'hooks/useVaults';\nimport { watch } from 'hooks/useObservable';\n\nvar NavbarItemContent = function NavbarItemContent(_ref) {\n  var children = _ref.children,\n      props = _objectWithoutProperties(_ref, [\"children\"]);\n\n  return /*#__PURE__*/React.createElement(Flex, Object.assign({\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    borderRadius: \"default\"\n  }, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 3\n    }\n  }), children);\n};\n\nvar _StyledLink = styled(Link).withConfig({\n  displayName: \"CDPList___StyledLink\",\n  componentId: \"sc-17422g-0\"\n})([\"display:block;\"]);\n\nvar NavbarItem = function NavbarItem(_ref2) {\n  var href = _ref2.href,\n      active = _ref2.active,\n      trackBtnClick = _ref2.trackBtnClick,\n      props = _objectWithoutProperties(_ref2, [\"href\", \"active\", \"trackBtnClick\"]);\n\n  return /*#__PURE__*/React.createElement(_StyledLink, Object.assign({\n    href: href,\n    active: active,\n    prefetch: true,\n    onClick: trackBtnClick\n  }, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(NavbarItemContent, Object.assign({}, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }\n  })));\n};\n\nvar _StyledFlex = styled(Flex).withConfig({\n  displayName: \"CDPList___StyledFlex\",\n  componentId: \"sc-17422g-1\"\n})([\"cursor:pointer;\"]);\n\nvar AddCdpButton = function AddCdpButton(_ref3) {\n  var account = _ref3.account,\n      show = _ref3.show,\n      mobile = _ref3.mobile;\n\n  var _useAnalytics = useAnalytics('NavBar'),\n      trackBtnClick = _useAnalytics.trackBtnClick;\n\n  return /*#__PURE__*/React.createElement(_StyledFlex, {\n    onClick: function onClick() {\n      trackBtnClick('CreateNew');\n      account && show({\n        modalType: 'cdpcreate',\n        modalTemplate: 'fullscreen'\n      });\n    },\n    width: mobile && \"\".concat(getMeasurement('navbarItemWidth'), \"px\"),\n    mx: mobile && '7px',\n    mt: mobile && '15px',\n    justifyContent: \"center\",\n    borderRadius: \"4px\",\n    py: \"s\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Plus, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }\n  }));\n};\n\n__signature__(AddCdpButton, \"useAnalytics{{ trackBtnClick }}\", function () {\n  return [useAnalytics];\n});\n\nvar DirectionalButton = styled(NavbarItemContent).withConfig({\n  displayName: \"CDPList__DirectionalButton\",\n  componentId: \"sc-17422g-2\"\n})([\"height:25px;cursor:pointer;visibility:\", \";\"], function (props) {\n  return props.show ? 'visible' : 'hidden';\n});\nvar CdpContainer = styled(Flex).withConfig({\n  displayName: \"CDPList__CdpContainer\",\n  componentId: \"sc-17422g-3\"\n})([\"cursor:pointer;flex-direction:\", \";flex-wrap:\", \";overflow:auto;\"], function (props) {\n  return props.mobile ? 'row' : 'column';\n}, function (props) {\n  return props.mobile ? 'wrap' : undefined;\n});\nvar CDPList = memo(__signature__(function (_ref4) {\n  var _this2 = this;\n\n  var currentPath = _ref4.currentPath,\n      viewedAddress = _ref4.viewedAddress,\n      currentQuery = _ref4.currentQuery,\n      mobile = _ref4.mobile;\n\n  var _useCurrentRoute = useCurrentRoute(),\n      url = _useCurrentRoute.url;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      listOpen = _useState2[0],\n      setListOpen = _useState2[1];\n\n  var _useMaker = useMaker(),\n      maker = _useMaker.maker,\n      account = _useMaker.account;\n\n  var _useVaults = useVaults(),\n      userVaults = _useVaults.userVaults;\n\n  var _useState3 = useState(currentPath),\n      _useState4 = _slicedToArray(_useState3, 2),\n      overviewPath = _useState4[0],\n      setOverviewPath = _useState4[1];\n\n  var _useAnalytics2 = useAnalytics('NavBar'),\n      _trackBtnClick = _useAnalytics2.trackBtnClick;\n\n  var active = currentPath === overviewPath;\n  var emergencyShutdownActive = watch.emergencyShutdownActive();\n  useMemo(function () {\n    var onSavePage = url.pathname.startsWith(\"/\".concat(Routes.SAVE));\n\n    if (onSavePage) {\n      setListOpen(false);\n    } else if (!onSavePage && (account || viewedAddress)) {\n      setListOpen(true);\n    }\n  }, [account, url, viewedAddress]);\n  useEffect(function () {\n    if (account) {\n      setOverviewPath(\"/\".concat(Routes.BORROW, \"/owner/\").concat(account.address));\n    } else if (viewedAddress) {\n      setOverviewPath(\"/\".concat(Routes.BORROW, \"/owner/\").concat(viewedAddress));\n    }\n  }, [maker, account, viewedAddress, setOverviewPath]);\n\n  var _useState5 = useState({\n    scrollTop: 0,\n    maxScrollTop: 1\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      scrollPosition = _useState6[0],\n      setScrollPosition = _useState6[1];\n\n  var scrollTop = scrollPosition.scrollTop;\n  var cdpContainerRef = useRef(null);\n\n  var handleOnScroll = function handleOnScroll() {\n    var maxScrollTop = cdpContainerRef.current.scrollHeight - cdpContainerRef.current.clientHeight;\n    setScrollPosition(_objectSpread({}, scrollPosition, {\n      scrollTop: cdpContainerRef.current.scrollTop,\n      maxScrollTop: maxScrollTop\n    }));\n  };\n\n  var debounced = debounce(handleOnScroll, 100);\n\n  var onDirectionalClick = function onDirectionalClick(direction) {\n    var scrollAmount = userVaults && cdpContainerRef.current.scrollHeight / userVaults.length;\n    var maxScrollTop = cdpContainerRef.current.scrollHeight - cdpContainerRef.current.clientHeight;\n    setScrollPosition(_objectSpread({}, scrollPosition, {\n      scrollAmount: scrollAmount\n    }));\n    var newPosition = direction === 'up' && scrollAmount ? scrollTop - scrollAmount : scrollTop + scrollAmount;\n    if (newPosition < 0) newPosition = 0;\n    if (newPosition > maxScrollTop) newPosition = maxScrollTop;\n    setScrollPosition(_objectSpread({}, scrollPosition, {\n      scrollTop: newPosition,\n      maxScrollTop: maxScrollTop\n    }));\n    cdpContainerRef.current.scrollTop = newPosition;\n  };\n\n  var _useModal = useModal(),\n      show = _useModal.show;\n\n  var getBgColor = function getBgColor(active, account) {\n    return active && account ? '#222B3F' : !active && account ? '#191E2B' : active && !account ? 'cardBg' : 'cardBg';\n  };\n\n  return listOpen && userVaults ? /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 5\n    }\n  }, userVaults.length >= 4 && !mobile && /*#__PURE__*/React.createElement(DirectionalButton, {\n    onClick: function onClick() {\n      return onDirectionalClick('up');\n    },\n    show: scrollTop > 0,\n    bg: account ? '#191E2B' : '#191E2B',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    bg: mobile ? '#131824' : '#131824',\n    height: \"100%\",\n    width: mobile ? '100vw' : \"\".concat(getMeasurement('navbarWidth'), \"px\"),\n    px: mobile ? '15px' : '5px',\n    pb: mobile && '15px',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CdpContainer, {\n    onScroll: debounced,\n    ref: cdpContainerRef,\n    cdpsLength: userVaults.length,\n    mobile: mobile,\n    pb: \"5px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(NavbarItem, {\n    key: userVaults.length * 10,\n    href: overviewPath + currentQuery,\n    mx: mobile && '7px',\n    mt: mobile ? '15px' : '5px',\n    bg: getBgColor(active, account),\n    height: \"\".concat(getMeasurement('navbarItemHeight'), \"px\"),\n    width: \"\".concat(getMeasurement('navbarItemWidth'), \"px\"),\n    trackBtnClick: function trackBtnClick() {\n      return _trackBtnClick('SelectOverview');\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    t: \"p6\",\n    fontWeight: \"bold\",\n    color: account ? '#DEDFE7' : '#DEDFE7',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 13\n    }\n  }, lang.overview)), userVaults.map(function (_ref5) {\n    var id = _ref5.id,\n        liquidationRatio = _ref5.liquidationRatio,\n        collateralizationRatio = _ref5.collateralizationRatio,\n        vaultType = _ref5.vaultType;\n    var linkPath = \"/\".concat(Routes.BORROW, \"/\").concat(id);\n    var active = currentPath === linkPath;\n    return /*#__PURE__*/React.createElement(NavbarItem, {\n      key: id,\n      href: linkPath + currentQuery,\n      mx: mobile && '7px',\n      mt: mobile ? '15px' : '5px',\n      bg: getBgColor(active, account),\n      height: \"\".concat(getMeasurement('navbarItemHeight'), \"px\"),\n      width: \"\".concat(getMeasurement('navbarItemWidth'), \"px\"),\n      trackBtnClick: function trackBtnClick() {\n        return _trackBtnClick('SelectVault', {\n          collateral: vaultType,\n          id: id\n        });\n      },\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Text, {\n      t: \"p6\",\n      fontWeight: \"bold\",\n      color: account ? '#A3B2CF' : '#F3F3F5',\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 19\n      }\n    }, vaultType), /*#__PURE__*/React.createElement(RatioDisplay, {\n      fontSize: \"1.3rem\",\n      ratio: collateralizationRatio.toBigNumber().dp(2).times(100),\n      ilkLiqRatio: liquidationRatio.toBigNumber().dp(2).times(100),\n      active: active,\n      __self: _this2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 19\n      }\n    }));\n  }), account && !emergencyShutdownActive && /*#__PURE__*/React.createElement(AddCdpButton, {\n    account: account,\n    show: show,\n    mobile: mobile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 13\n    }\n  }))), userVaults.length >= 4 && !mobile) : null;\n}, \"useCurrentRoute{{ url }}\\nuseState{[listOpen, setListOpen](false)}\\nuseMaker{{ maker, account }}\\nuseVaults{{ userVaults }}\\nuseState{[overviewPath, setOverviewPath](currentPath)}\\nuseAnalytics{{ trackBtnClick }}\\nuseMemo{}\\nuseEffect{}\\nuseState{[scrollPosition, setScrollPosition]({\\n    scrollTop: 0,\\n    maxScrollTop: 1\\n  })}\\nuseRef{cdpContainerRef}\\nuseModal{{ show }}\", function () {\n  return [useCurrentRoute, useMaker, useVaults, useAnalytics, useModal];\n}));\nvar _default = CDPList;\nexport default _default;\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(NavbarItemContent, \"NavbarItemContent\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js\");\n  reactHotLoader.register(NavbarItem, \"NavbarItem\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js\");\n  reactHotLoader.register(AddCdpButton, \"AddCdpButton\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js\");\n  reactHotLoader.register(DirectionalButton, \"DirectionalButton\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js\");\n  reactHotLoader.register(CdpContainer, \"CdpContainer\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js\");\n  reactHotLoader.register(CDPList, \"CDPList\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js\");\n  reactHotLoader.register(_default, \"default\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/components/CDPList.js"],"names":["debounce","React","memo","useEffect","useState","useRef","useMemo","Fragment","styled","Flex","Text","Box","RatioDisplay","Link","useCurrentRoute","useModal","useMaker","useAnalytics","Routes","getMeasurement","lang","useVaults","watch","NavbarItemContent","children","props","NavbarItem","href","active","trackBtnClick","AddCdpButton","account","show","mobile","modalType","modalTemplate","DirectionalButton","CdpContainer","undefined","CDPList","currentPath","viewedAddress","currentQuery","url","listOpen","setListOpen","maker","userVaults","overviewPath","setOverviewPath","emergencyShutdownActive","onSavePage","pathname","startsWith","SAVE","BORROW","address","scrollTop","maxScrollTop","scrollPosition","setScrollPosition","cdpContainerRef","handleOnScroll","current","scrollHeight","clientHeight","debounced","onDirectionalClick","direction","scrollAmount","length","newPosition","getBgColor","overview","map","id","liquidationRatio","collateralizationRatio","vaultType","linkPath","collateral","toBigNumber","dp","times"],"mappings":"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","sourcesContent":["import debounce from 'lodash.debounce';\nimport React, {\n  memo,\n  useEffect,\n  useState,\n  useRef,\n  useMemo,\n  Fragment\n} from 'react';\nimport styled from 'styled-components';\nimport { ReactComponent as Plus } from '../images/plus.svg';\nimport { Flex, Text, Box } from '@makerdao/ui-components-core';\nimport RatioDisplay from './RatioDisplay';\nimport { Link, useCurrentRoute } from 'react-navi';\nimport useModal from 'hooks/useModal';\nimport useMaker from 'hooks/useMaker';\nimport useAnalytics from 'hooks/useAnalytics';\nimport { Routes } from '../utils/constants';\nimport { getMeasurement } from '../styles/theme';\nimport lang from 'languages';\nimport useVaults from 'hooks/useVaults';\nimport { watch } from 'hooks/useObservable';\n\nconst NavbarItemContent = ({ children, ...props }) => (\n  <Flex\n    flexDirection=\"column\"\n    alignItems=\"center\"\n    justifyContent=\"center\"\n    borderRadius=\"default\"\n    {...props}\n  >\n    {children}\n  </Flex>\n);\n\nconst NavbarItem = ({ href, active, trackBtnClick, ...props }) => {\n  return (\n    <Link\n      href={href}\n      active={active}\n      prefetch={true}\n      onClick={trackBtnClick}\n      css={`\n        display: block;\n      `}\n      {...props}\n    >\n      <NavbarItemContent {...props} />\n    </Link>\n  );\n};\n\nconst AddCdpButton = ({ account, show, mobile }) => {\n  const { trackBtnClick } = useAnalytics('NavBar');\n  return (\n    <Flex\n      onClick={() => {\n        trackBtnClick('CreateNew');\n        account &&\n          show({ modalType: 'cdpcreate', modalTemplate: 'fullscreen' });\n      }}\n      width={mobile && `${getMeasurement('navbarItemWidth')}px`}\n      mx={mobile && '7px'}\n      mt={mobile && '15px'}\n      justifyContent=\"center\"\n      borderRadius=\"4px\"\n      py=\"s\"\n      css={`\n        cursor: pointer;\n      `}\n    >\n      <Plus />\n    </Flex>\n  );\n};\n\nconst DirectionalButton = styled(NavbarItemContent)`\n  height: 25px;\n  cursor: pointer;\n  visibility: ${props => (props.show ? 'visible' : 'hidden')};\n`;\n\nconst CdpContainer = styled(Flex)`\n  cursor: pointer;\n  flex-direction: ${props => (props.mobile ? 'row' : 'column')};\n  flex-wrap: ${props => (props.mobile ? 'wrap' : undefined)};\n  overflow: auto;\n`;\n\nconst CDPList = memo(function({\n  currentPath,\n  viewedAddress,\n  currentQuery,\n  mobile\n}) {\n  const { url } = useCurrentRoute();\n  const [listOpen, setListOpen] = useState(false);\n  const { maker, account } = useMaker();\n  const { userVaults } = useVaults();\n  const [overviewPath, setOverviewPath] = useState(currentPath);\n  const { trackBtnClick } = useAnalytics('NavBar');\n  const active = currentPath === overviewPath;\n  const emergencyShutdownActive = watch.emergencyShutdownActive();\n\n  useMemo(() => {\n    const onSavePage = url.pathname.startsWith(`/${Routes.SAVE}`);\n    if (onSavePage) {\n      setListOpen(false);\n    } else if (!onSavePage && (account || viewedAddress)) {\n      setListOpen(true);\n    }\n  }, [account, url, viewedAddress]);\n\n  useEffect(() => {\n    if (account) {\n      setOverviewPath(`/${Routes.BORROW}/owner/${account.address}`);\n    } else if (viewedAddress) {\n      setOverviewPath(`/${Routes.BORROW}/owner/${viewedAddress}`);\n    }\n  }, [maker, account, viewedAddress, setOverviewPath]);\n\n  const [scrollPosition, setScrollPosition] = useState({\n    scrollTop: 0,\n    maxScrollTop: 1\n  });\n  const { scrollTop } = scrollPosition;\n\n  const cdpContainerRef = useRef(null);\n\n  const handleOnScroll = () => {\n    const maxScrollTop =\n      cdpContainerRef.current.scrollHeight -\n      cdpContainerRef.current.clientHeight;\n\n    setScrollPosition({\n      ...scrollPosition,\n      scrollTop: cdpContainerRef.current.scrollTop,\n      maxScrollTop\n    });\n  };\n\n  const debounced = debounce(handleOnScroll, 100);\n\n  const onDirectionalClick = direction => {\n    const scrollAmount =\n      userVaults && cdpContainerRef.current.scrollHeight / userVaults.length;\n    const maxScrollTop =\n      cdpContainerRef.current.scrollHeight -\n      cdpContainerRef.current.clientHeight;\n\n    setScrollPosition({\n      ...scrollPosition,\n      scrollAmount\n    });\n    let newPosition =\n      direction === 'up' && scrollAmount\n        ? scrollTop - scrollAmount\n        : scrollTop + scrollAmount;\n    if (newPosition < 0) newPosition = 0;\n    if (newPosition > maxScrollTop) newPosition = maxScrollTop;\n    setScrollPosition({\n      ...scrollPosition,\n      scrollTop: newPosition,\n      maxScrollTop\n    });\n    cdpContainerRef.current.scrollTop = newPosition;\n  };\n\n  const { show } = useModal();\n\n  const getBgColor = (active, account) =>\n    active && account\n      ? '#222B3F'\n      : !active && account\n      ? '#191E2B'\n      : active && !account\n      ? 'cardBg'\n      : 'cardBg';\n\n  return listOpen && userVaults ? (\n    <Fragment>\n      {userVaults.length >= 4 && !mobile && (\n        <DirectionalButton\n          onClick={() => onDirectionalClick('up')}\n          show={scrollTop > 0}\n          bg={account ? '#191E2B' : '#191E2B'}\n        >\n        </DirectionalButton>\n      )}\n      <Box\n        bg={mobile ? '#131824' : '#131824'}\n        height=\"100%\"\n        width={mobile ? '100vw' : `${getMeasurement('navbarWidth')}px`}\n        px={mobile ? '15px' : '5px'}\n        pb={mobile && '15px'}\n      >\n        <CdpContainer\n          onScroll={debounced}\n          ref={cdpContainerRef}\n          cdpsLength={userVaults.length}\n          mobile={mobile}\n          pb=\"5px\"\n        >\n          <NavbarItem\n            key={userVaults.length * 10}\n            href={overviewPath + currentQuery}\n            mx={mobile && '7px'}\n            mt={mobile ? '15px' : '5px'}\n            bg={getBgColor(active, account)}\n            height={`${getMeasurement('navbarItemHeight')}px`}\n            width={`${getMeasurement('navbarItemWidth')}px`}\n            trackBtnClick={() => trackBtnClick('SelectOverview')}\n          >\n            <Text\n              t=\"p6\"\n              fontWeight=\"bold\"\n              color={account ? '#DEDFE7' : '#DEDFE7'}\n            >\n              {lang.overview}\n            </Text>\n          </NavbarItem>\n          {userVaults.map(\n            ({ id, liquidationRatio, collateralizationRatio, vaultType }) => {\n              const linkPath = `/${Routes.BORROW}/${id}`;\n              const active = currentPath === linkPath;\n              return (\n                <NavbarItem\n                  key={id}\n                  href={linkPath + currentQuery}\n                  mx={mobile && '7px'}\n                  mt={mobile ? '15px' : '5px'}\n                  bg={getBgColor(active, account)}\n                  height={`${getMeasurement('navbarItemHeight')}px`}\n                  width={`${getMeasurement('navbarItemWidth')}px`}\n                  trackBtnClick={() =>\n                    trackBtnClick('SelectVault', {\n                      collateral: vaultType,\n                      id\n                    })\n                  }\n                >\n                  <Text\n                    t=\"p6\"\n                    fontWeight=\"bold\"\n                    color={account ? '#A3B2CF' : '#F3F3F5'}\n                  >\n                    {vaultType}\n                  </Text>\n                  <RatioDisplay\n                    fontSize=\"1.3rem\"\n                    ratio={collateralizationRatio\n                      .toBigNumber()\n                      .dp(2)\n                      .times(100)}\n                    ilkLiqRatio={liquidationRatio\n                      .toBigNumber()\n                      .dp(2)\n                      .times(100)}\n                    active={active}\n                  />\n                </NavbarItem>\n              );\n            }\n          )}\n          {account && !emergencyShutdownActive && (\n            <AddCdpButton account={account} show={show} mobile={mobile} />\n          )}\n        </CdpContainer>\n      </Box>\n      {userVaults.length >= 4 && !mobile }\n    </Fragment>\n  ) : null;\n});\n\nexport default CDPList;\n"]},"metadata":{},"sourceType":"module"}