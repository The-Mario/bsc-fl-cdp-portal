{"ast":null,"code":"import _slicedToArray from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport { PublicService } from '@makerdao/services-core';\nimport { RAD, RAY, ServiceRoles, SECONDS_PER_YEAR } from './constants';\nimport BigNumber from 'bignumber.js';\nimport { USDFL } from './index';\n\nvar SystemDataService = /*#__PURE__*/function (_PublicService) {\n  _inherits(SystemDataService, _PublicService);\n\n  var _super = _createSuper(SystemDataService);\n\n  function SystemDataService() {\n    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ServiceRoles.SYSTEM_DATA;\n\n    _classCallCheck(this, SystemDataService);\n\n    return _super.call(this, name, ['smartContract', 'token']);\n  }\n\n  _createClass(SystemDataService, [{\n    key: \"getAnnualBaseRate\",\n    value: function () {\n      var _getAnnualBaseRate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var base, baseBigNumber;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.jug.base();\n\n              case 2:\n                base = _context.sent;\n                baseBigNumber = new BigNumber(base.toString()).dividedBy(RAY).plus(1);\n                return _context.abrupt(\"return\", baseBigNumber.pow(SECONDS_PER_YEAR).minus(1).toNumber());\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getAnnualBaseRate() {\n        return _getAnnualBaseRate.apply(this, arguments);\n      }\n\n      return getAnnualBaseRate;\n    }()\n  }, {\n    key: \"getSystemWideDebtCeiling\",\n    value: function () {\n      var _getSystemWideDebtCeiling = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var Line;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.vat.Line();\n\n              case 2:\n                Line = _context2.sent;\n                return _context2.abrupt(\"return\", new BigNumber(Line.toString()).dividedBy(RAD).toNumber());\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getSystemWideDebtCeiling() {\n        return _getSystemWideDebtCeiling.apply(this, arguments);\n      }\n\n      return getSystemWideDebtCeiling;\n    }()\n  }, {\n    key: \"adapterAddress\",\n    value: function adapterAddress(ilk) {\n      var key = 'MCD_JOIN_' + ilk.replace(/-/g, '_');\n      return this.get('smartContract').getContractAddress(key);\n    }\n  }, {\n    key: \"isGlobalSettlementInvoked\",\n    value: function () {\n      var _isGlobalSettlementInvoked = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var live;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.get('smartContract').getContract('MCD_END').live();\n\n              case 2:\n                live = _context3.sent;\n                return _context3.abrupt(\"return\", live.eq(0));\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function isGlobalSettlementInvoked() {\n        return _isGlobalSettlementInvoked.apply(this, arguments);\n      }\n\n      return isGlobalSettlementInvoked;\n    }()\n  }, {\n    key: \"getSystemSurplus\",\n    value: function () {\n      var _getSystemSurplus = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var vowAddr, _yield$Promise$all, _yield$Promise$all2, dai, sin;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                vowAddr = this.get('smartContract').getContractAddress('MCD_VOW');\n                _context4.next = 3;\n                return Promise.all([this.vat.dai(vowAddr), this.vat.sin(vowAddr)]);\n\n              case 3:\n                _yield$Promise$all = _context4.sent;\n                _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 2);\n                dai = _yield$Promise$all2[0];\n                sin = _yield$Promise$all2[1];\n                return _context4.abrupt(\"return\", USDFL.rad(dai).minus(USDFL.rad(sin)));\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getSystemSurplus() {\n        return _getSystemSurplus.apply(this, arguments);\n      }\n\n      return getSystemSurplus;\n    }()\n  }, {\n    key: \"getTotalDai\",\n    value: function () {\n      var _getTotalDai = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.t0 = USDFL;\n                _context5.next = 3;\n                return this.vat.debt();\n\n              case 3:\n                _context5.t1 = _context5.sent;\n                return _context5.abrupt(\"return\", _context5.t0.rad.call(_context5.t0, _context5.t1));\n\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function getTotalDai() {\n        return _getTotalDai.apply(this, arguments);\n      }\n\n      return getTotalDai;\n    }() // Helpers ----------------------------------------------\n\n  }, {\n    key: \"__reactstandin__regenerateByEval\",\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }, {\n    key: \"cat\",\n    get: function get() {\n      return this.get('smartContract').getContract('MCD_CAT');\n    }\n  }, {\n    key: \"jug\",\n    get: function get() {\n      return this.get('smartContract').getContract('MCD_JUG');\n    }\n  }, {\n    key: \"vat\",\n    get: function get() {\n      return this.get('smartContract').getContract('MCD_VAT');\n    }\n  }, {\n    key: \"spot\",\n    get: function get() {\n      return this.get('smartContract').getContract('MCD_SPOT');\n    }\n  }]);\n\n  return SystemDataService;\n}(PublicService);\n\nexport { SystemDataService as default };\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(SystemDataService, \"SystemDataService\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/libs/dai-plugin-mcd/src/SystemDataService.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/libs/dai-plugin-mcd/src/SystemDataService.js"],"names":["PublicService","RAD","RAY","ServiceRoles","SECONDS_PER_YEAR","BigNumber","USDFL","SystemDataService","name","SYSTEM_DATA","jug","base","baseBigNumber","toString","dividedBy","plus","pow","minus","toNumber","vat","Line","ilk","key","replace","get","getContractAddress","getContract","live","eq","vowAddr","Promise","all","dai","sin","rad","debt"],"mappings":";;;;;;;;;;;;;;;;;AAAA,SAASA,aAAT,QAA8B,yBAA9B;AACA,SAASC,GAAT,EAAcC,GAAd,EAAmBC,YAAnB,EAAiCC,gBAAjC,QAAyD,aAAzD;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,SAASC,KAAT,QAAsB,SAAtB;;IAEqBC,iB;;;;;AACnB,+BAA6C;AAAA,QAAjCC,IAAiC,uEAA1BL,YAAY,CAACM,WAAa;;AAAA;;AAAA,6BACrCD,IADqC,EAC/B,CAAC,eAAD,EAAkB,OAAlB,CAD+B;AAE5C;;;;;;;;;;;;uBAGoB,KAAKE,GAAL,CAASC,IAAT,E;;;AAAbA,gBAAAA,I;AACAC,gBAAAA,a,GAAgB,IAAIP,SAAJ,CAAcM,IAAI,CAACE,QAAL,EAAd,EAA+BC,SAA/B,CAAyCZ,GAAzC,EAA8Ca,IAA9C,CAAmD,CAAnD,C;iDACfH,aAAa,CACjBI,GADI,CACAZ,gBADA,EAEJa,KAFI,CAEE,CAFF,EAGJC,QAHI,E;;;;;;;;;;;;;;;;;;;;;;;;;;uBAOY,KAAKC,GAAL,CAASC,IAAT,E;;;AAAbA,gBAAAA,I;kDACC,IAAIf,SAAJ,CAAce,IAAI,CAACP,QAAL,EAAd,EAA+BC,SAA/B,CAAyCb,GAAzC,EAA8CiB,QAA9C,E;;;;;;;;;;;;;;;;;;mCAGMG,G,EAAK;AAClB,UAAMC,GAAG,GAAG,cAAcD,GAAG,CAACE,OAAJ,CAAY,IAAZ,EAAkB,GAAlB,CAA1B;AACA,aAAO,KAAKC,GAAL,CAAS,eAAT,EAA0BC,kBAA1B,CAA6CH,GAA7C,CAAP;AACD;;;;;;;;;;;uBAGoB,KAAKE,GAAL,CAAS,eAAT,EAChBE,WADgB,CACJ,SADI,EAEhBC,IAFgB,E;;;AAAbA,gBAAAA,I;kDAGCA,IAAI,CAACC,EAAL,CAAQ,CAAR,C;;;;;;;;;;;;;;;;;;;;;;;;;;AAIDC,gBAAAA,O,GAAU,KAAKL,GAAL,CAAS,eAAT,EAA0BC,kBAA1B,CAA6C,SAA7C,C;;uBACSK,OAAO,CAACC,GAAR,CAAY,CACnC,KAAKZ,GAAL,CAASa,GAAT,CAAaH,OAAb,CADmC,EAEnC,KAAKV,GAAL,CAASc,GAAT,CAAaJ,OAAb,CAFmC,CAAZ,C;;;;;AAAlBG,gBAAAA,G;AAAKC,gBAAAA,G;kDAIL3B,KAAK,CAAC4B,GAAN,CAAUF,GAAV,EAAef,KAAf,CAAqBX,KAAK,CAAC4B,GAAN,CAAUD,GAAV,CAArB,C;;;;;;;;;;;;;;;;;;;;;;;;+BAIA3B,K;;uBAAgB,KAAKa,GAAL,CAASgB,IAAT,E;;;;+DAAVD,G;;;;;;;;;;;;;;;QAGf;;;;;;;;;;;wBAEU;AACR,aAAO,KAAKV,GAAL,CAAS,eAAT,EAA0BE,WAA1B,CAAsC,SAAtC,CAAP;AACD;;;wBAES;AACR,aAAO,KAAKF,GAAL,CAAS,eAAT,EAA0BE,WAA1B,CAAsC,SAAtC,CAAP;AACD;;;wBAES;AACR,aAAO,KAAKF,GAAL,CAAS,eAAT,EAA0BE,WAA1B,CAAsC,SAAtC,CAAP;AACD;;;wBAEU;AACT,aAAO,KAAKF,GAAL,CAAS,eAAT,EAA0BE,WAA1B,CAAsC,UAAtC,CAAP;AACD;;;;EA5D4C1B,a;;SAA1BO,iB;;;;;;;;;;0BAAAA,iB","sourcesContent":["import { PublicService } from '@makerdao/services-core';\nimport { RAD, RAY, ServiceRoles, SECONDS_PER_YEAR } from './constants';\nimport BigNumber from 'bignumber.js';\nimport { USDFL } from './index';\n\nexport default class SystemDataService extends PublicService {\n  constructor(name = ServiceRoles.SYSTEM_DATA) {\n    super(name, ['smartContract', 'token']);\n  }\n\n  async getAnnualBaseRate() {\n    const base = await this.jug.base();\n    const baseBigNumber = new BigNumber(base.toString()).dividedBy(RAY).plus(1);\n    return baseBigNumber\n      .pow(SECONDS_PER_YEAR)\n      .minus(1)\n      .toNumber();\n  }\n\n  async getSystemWideDebtCeiling() {\n    const Line = await this.vat.Line();\n    return new BigNumber(Line.toString()).dividedBy(RAD).toNumber();\n  }\n\n  adapterAddress(ilk) {\n    const key = 'MCD_JOIN_' + ilk.replace(/-/g, '_');\n    return this.get('smartContract').getContractAddress(key);\n  }\n\n  async isGlobalSettlementInvoked() {\n    const live = await this.get('smartContract')\n      .getContract('MCD_END')\n      .live();\n    return live.eq(0);\n  }\n\n  async getSystemSurplus() {\n    const vowAddr = this.get('smartContract').getContractAddress('MCD_VOW');\n    const [dai, sin] = await Promise.all([\n      this.vat.dai(vowAddr),\n      this.vat.sin(vowAddr)\n    ]);\n    return USDFL.rad(dai).minus(USDFL.rad(sin));\n  }\n\n  async getTotalDai() {\n    return USDFL.rad(await this.vat.debt());\n  }\n\n  // Helpers ----------------------------------------------\n\n  get cat() {\n    return this.get('smartContract').getContract('MCD_CAT');\n  }\n\n  get jug() {\n    return this.get('smartContract').getContract('MCD_JUG');\n  }\n\n  get vat() {\n    return this.get('smartContract').getContract('MCD_VAT');\n  }\n\n  get spot() {\n    return this.get('smartContract').getContract('MCD_SPOT');\n  }\n}\n"]},"metadata":{},"sourceType":"module"}