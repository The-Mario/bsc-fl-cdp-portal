{"ast":null,"code":"\"use strict\";\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime/helpers/typeof\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _uniq = _interopRequireDefault(require(\"lodash/uniq\"));\n\nvar _Container = _interopRequireDefault(require(\"./Container\"));\n\nvar _standardizeConfig3 = _interopRequireDefault(require(\"./standardizeConfig\"));\n\nvar ServiceProvider = /*#__PURE__*/function () {\n  function ServiceProvider(config, _ref) {\n    var services = _ref.services,\n        defaults = _ref.defaults,\n        disabled = _ref.disabled;\n    (0, _classCallCheck2[\"default\"])(this, ServiceProvider);\n    this._config = config; // all the service classes that this provider should support\n\n    this._services = services; // the services (as string names) that should be used for each role by\n    // default, or when that role is disabled\n\n    this._resolver = {\n      defaults: defaults,\n      disabled: disabled\n    };\n  }\n  /**\n   * @param {string} serviceName\n   * @returns {boolean}\n   */\n\n\n  (0, _createClass2[\"default\"])(ServiceProvider, [{\n    key: \"supports\",\n    value: function supports(serviceName) {\n      return !!this._services[serviceName];\n    }\n    /**\n     * @param {object} servicesConfig\n     * @returns {Container}\n     */\n\n  }, {\n    key: \"buildContainer\",\n    value: function buildContainer() {\n      var container = new _Container[\"default\"]();\n\n      for (var role in this._config) {\n        var _standardizeConfig = (0, _standardizeConfig3[\"default\"])(role, this._config[role], this._resolver),\n            _standardizeConfig2 = (0, _slicedToArray2[\"default\"])(_standardizeConfig, 2),\n            service = _standardizeConfig2[0],\n            settings = _standardizeConfig2[1];\n\n        var instance = void 0; // each config can contain a service descriptor in one of several forms:\n\n        if ((0, _typeof2[\"default\"])(service) == 'object') {\n          // instance\n          instance = service;\n        } else if (typeof service == 'function') {\n          // constructor\n          instance = new service();\n        } else {\n          // string\n          if (!this.supports(service) && role === 'exchange') {\n            throw new Error('This service has been extracted from dai.js. Please refer to the documentation to add it as a plugin: \\n\\n https://github.com/makerdao/dai.js/wiki/Basic-Usage-(Plugins)');\n          }\n\n          if (!this.supports(service)) {\n            throw new Error('Unsupported service in configuration: ' + service);\n          }\n\n          instance = new this._services[service]();\n        }\n\n        instance.manager().settings(settings);\n        container.register(instance, role);\n      }\n\n      this._registerDependencies(container);\n\n      container.injectDependencies();\n      this._container = container;\n      return container;\n    }\n  }, {\n    key: \"_registerDependencies\",\n    value: function _registerDependencies(container) {\n      var names = container.getRegisteredServiceNames(); // get the names of all dependencies\n\n      var allDeps = names.reduce(function (acc, name) {\n        var service = container.service(name);\n        var deps = service.manager().dependencies();\n        return (0, _uniq[\"default\"])(acc.concat(deps));\n      }, []); // filter out the ones that are already registered\n\n      var newDeps = allDeps.filter(function (name) {\n        return !names.includes(name);\n      });\n      if (newDeps.length === 0) return; // register any remaining ones\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = newDeps[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var name = _step.value;\n          var className = this._resolver.defaults[name];\n          var ctor = this._services[className];\n          if (!ctor) throw new Error(\"No service found for \\\"\".concat(name, \"\\\"\"));\n          container.register(new ctor(), name);\n        } // repeat, to find any dependencies for services that were just added\n\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n            _iterator[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      this._registerDependencies(container);\n    }\n  }, {\n    key: \"service\",\n    value: function service(name) {\n      if (!this._container) this.buildContainer();\n      return this._container.service(name);\n    }\n  }]);\n  return ServiceProvider;\n}();\n\nexports[\"default\"] = ServiceProvider;\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(_typeof2, \"_typeof2\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/@makerdao/services-core/dist/ServiceProvider.js\");\n  reactHotLoader.register(_slicedToArray2, \"_slicedToArray2\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/@makerdao/services-core/dist/ServiceProvider.js\");\n  reactHotLoader.register(_classCallCheck2, \"_classCallCheck2\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/@makerdao/services-core/dist/ServiceProvider.js\");\n  reactHotLoader.register(_createClass2, \"_createClass2\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/@makerdao/services-core/dist/ServiceProvider.js\");\n  reactHotLoader.register(_uniq, \"_uniq\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/@makerdao/services-core/dist/ServiceProvider.js\");\n  reactHotLoader.register(_Container, \"_Container\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/@makerdao/services-core/dist/ServiceProvider.js\");\n  reactHotLoader.register(_standardizeConfig3, \"_standardizeConfig3\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/@makerdao/services-core/dist/ServiceProvider.js\");\n  reactHotLoader.register(ServiceProvider, \"ServiceProvider\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/@makerdao/services-core/dist/ServiceProvider.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":null,"metadata":{},"sourceType":"script"}