{"ast":null,"code":"'use strict';\n/*\n * Uses ethereumjs-tx to sign a transaction.\n *\n * The two callbacks a user needs to implement are:\n * - getAccounts() -- array of addresses supported\n * - getPrivateKey(address) -- return private key for a given address\n *\n * Optionally approveTransaction(), approveMessage() can be supplied too.\n */\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nvar inherits = require('util').inherits;\n\nvar HookedWalletProvider = require('./hooked-wallet.js');\n\nvar EthTx = require('ethereumjs-tx');\n\nvar ethUtil = require('ethereumjs-util');\n\nvar sigUtil = require('eth-sig-util');\n\nmodule.exports = HookedWalletEthTxSubprovider;\ninherits(HookedWalletEthTxSubprovider, HookedWalletProvider);\n\nfunction HookedWalletEthTxSubprovider(opts) {\n  var self = this;\n  HookedWalletEthTxSubprovider.super_.call(self, opts);\n\n  self.signTransaction = function (txData, cb) {\n    // defaults\n    if (txData.gas !== undefined) txData.gasLimit = txData.gas;\n    txData.value = txData.value || '0x00';\n    txData.data = ethUtil.addHexPrefix(txData.data);\n    opts.getPrivateKey(txData.from, function (err, privateKey) {\n      if (err) return cb(err);\n      var tx = new EthTx(txData);\n      tx.sign(privateKey);\n      cb(null, '0x' + tx.serialize().toString('hex'));\n    });\n  };\n\n  self.signMessage = function (msgParams, cb) {\n    opts.getPrivateKey(msgParams.from, function (err, privateKey) {\n      if (err) return cb(err);\n      var dataBuff = ethUtil.toBuffer(msgParams.data);\n      var msgHash = ethUtil.hashPersonalMessage(dataBuff);\n      var sig = ethUtil.ecsign(msgHash, privateKey);\n      var serialized = ethUtil.bufferToHex(concatSig(sig.v, sig.r, sig.s));\n      cb(null, serialized);\n    });\n  };\n\n  self.signPersonalMessage = function (msgParams, cb) {\n    opts.getPrivateKey(msgParams.from, function (err, privateKey) {\n      if (err) return cb(err);\n      var serialized = sigUtil.personalSign(privateKey, msgParams);\n      cb(null, serialized);\n    });\n  };\n\n  self.signTypedMessage = function (msgParams, cb) {\n    opts.getPrivateKey(msgParams.from, function (err, privateKey) {\n      if (err) return cb(err);\n      var serialized = sigUtil.signTypedData(privateKey, msgParams);\n      cb(null, serialized);\n    });\n  };\n}\n\nfunction concatSig(v, r, s) {\n  r = ethUtil.fromSigned(r);\n  s = ethUtil.fromSigned(s);\n  v = ethUtil.bufferToInt(v);\n  r = ethUtil.toUnsigned(r).toString('hex');\n  s = ethUtil.toUnsigned(s).toString('hex');\n  v = ethUtil.stripHexPrefix(ethUtil.intToHex(v));\n  return ethUtil.addHexPrefix(r.concat(s, v).toString(\"hex\"));\n}\n\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(inherits, \"inherits\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/web3-provider-engine/dist/es5/subproviders/hooked-wallet-ethtx.js\");\n  reactHotLoader.register(HookedWalletEthTxSubprovider, \"HookedWalletEthTxSubprovider\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/web3-provider-engine/dist/es5/subproviders/hooked-wallet-ethtx.js\");\n  reactHotLoader.register(concatSig, \"concatSig\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/web3-provider-engine/dist/es5/subproviders/hooked-wallet-ethtx.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":null,"metadata":{},"sourceType":"script"}