{"ast":null,"code":"import _regeneratorRuntime from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _applyDecoratedDescriptor from \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor\";\n\nvar _class;\n\n(function () {\n  var enterModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.enterModule : undefined;\n  enterModule && enterModule(module);\n})();\n\nvar __signature__ = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default.signature : function (a) {\n  return a;\n};\n\nimport { PublicService } from '@makerdao/services-core';\nimport { ServiceRoles } from './constants';\nimport BigNumber from 'bignumber.js';\nimport tracksTransactions from './utils/tracksTransactions';\nimport ERC20TokenAbi from '../contracts/abis/ERC20.json';\nvar RewardService = (_class = /*#__PURE__*/function (_PublicService) {\n  _inherits(RewardService, _PublicService);\n\n  var _super = _createSuper(RewardService);\n\n  function RewardService() {\n    var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : ServiceRoles.REWARDS;\n\n    _classCallCheck(this, RewardService);\n\n    return _super.call(this, name, ['smartContract', 'proxy', 'accounts', 'web3', ServiceRoles.SYSTEM_DATA]);\n  }\n\n  _createClass(RewardService, [{\n    key: \"holder\",\n    value: function holder(highRisk) {\n      return this.get('smartContract').getContract(highRisk ? 'FL_REWARDER_GOV_USD_HOLDER' : 'FL_REWARDER_STABLES_HOLDER');\n    }\n  }, {\n    key: \"claimReward\",\n    value: function () {\n      var _claimReward = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n        var promise;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                promise = _ref.promise;\n                return _context.abrupt(\"return\", this.proxyActions.claimReward(this.get('smartContract').getContractAddress('FL_REWARDER'), {\n                  dsProxy: true,\n                  promise: promise\n                }));\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function claimReward(_x) {\n        return _claimReward.apply(this, arguments);\n      }\n\n      return claimReward;\n    }()\n  }, {\n    key: \"lockPool\",\n    value: function () {\n      var _lockPool = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(amount, gem, highRisk, _ref2) {\n        var promise;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                promise = _ref2.promise;\n                return _context2.abrupt(\"return\", this.holder(highRisk).stake(amount, gem, {\n                  dsProxy: false,\n                  promise: promise\n                }));\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function lockPool(_x2, _x3, _x4, _x5) {\n        return _lockPool.apply(this, arguments);\n      }\n\n      return lockPool;\n    }()\n  }, {\n    key: \"unlockPool\",\n    value: function () {\n      var _unlockPool = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(amount, gem, highRisk, _ref3) {\n        var promise;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                promise = _ref3.promise;\n                return _context3.abrupt(\"return\", this.holder(highRisk).withdraw(amount, gem, {\n                  dsProxy: false,\n                  promise: promise\n                }));\n\n              case 2:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function unlockPool(_x6, _x7, _x8, _x9) {\n        return _unlockPool.apply(this, arguments);\n      }\n\n      return unlockPool;\n    }()\n  }, {\n    key: \"poolApprove\",\n    value: function () {\n      var _poolApprove = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(amount, gem, highRisk, _ref4) {\n        var promise, scs, contract;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                promise = _ref4.promise;\n                scs = this.get('smartContract');\n                contract = scs.getContractByAddressAndAbi(gem, ERC20TokenAbi);\n                return _context4.abrupt(\"return\", contract.approve(this.holder(highRisk).address, -1, {\n                  dsProxy: false,\n                  promise: promise\n                }));\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function poolApprove(_x10, _x11, _x12, _x13) {\n        return _poolApprove.apply(this, arguments);\n      }\n\n      return poolApprove;\n    }()\n  }, {\n    key: \"claimRewardEx\",\n    value: function () {\n      var _claimRewardEx = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(_ref5) {\n        var promise;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                promise = _ref5.promise;\n                return _context5.abrupt(\"return\", this.get('smartContract').getContract('FL_REWARD_AGGREGATOR').claimReward({\n                  dsProxy: false,\n                  promise: promise\n                }));\n\n              case 2:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function claimRewardEx(_x14) {\n        return _claimRewardEx.apply(this, arguments);\n      }\n\n      return claimRewardEx;\n    }()\n  }, {\n    key: \"claimRewardHiRisk\",\n    value: function () {\n      var _claimRewardHiRisk = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(_ref6) {\n        var promise;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                promise = _ref6.promise;\n                return _context6.abrupt(\"return\", this.get('smartContract').getContract('FL_REWARDER_GOV_USD').getReward({\n                  dsProxy: false,\n                  promise: promise\n                }));\n\n              case 2:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function claimRewardHiRisk(_x15) {\n        return _claimRewardHiRisk.apply(this, arguments);\n      }\n\n      return claimRewardHiRisk;\n    }()\n  }, {\n    key: \"claimRewardLowRisk\",\n    value: function () {\n      var _claimRewardLowRisk = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(_ref7) {\n        var promise;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                promise = _ref7.promise;\n                return _context7.abrupt(\"return\", this.get('smartContract').getContract('FL_REWARDER_STABLES').getReward({\n                  dsProxy: false,\n                  promise: promise\n                }));\n\n              case 2:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function claimRewardLowRisk(_x16) {\n        return _claimRewardLowRisk.apply(this, arguments);\n      }\n\n      return claimRewardLowRisk;\n    }()\n  }, {\n    key: \"__reactstandin__regenerateByEval\",\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }, {\n    key: \"proxyActions\",\n    get: function get() {\n      return this.get('smartContract').getContract('PROXY_ACTIONS_REWARD');\n    }\n  }, {\n    key: \"holderHighRisk\",\n    get: function get() {\n      return this.get('smartContract').getContract('FL_REWARDER_GOV_USD_HOLDER');\n    }\n  }]);\n\n  return RewardService;\n}(PublicService), (_applyDecoratedDescriptor(_class.prototype, \"claimReward\", [tracksTransactions], Object.getOwnPropertyDescriptor(_class.prototype, \"claimReward\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"lockPool\", [tracksTransactions], Object.getOwnPropertyDescriptor(_class.prototype, \"lockPool\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"unlockPool\", [tracksTransactions], Object.getOwnPropertyDescriptor(_class.prototype, \"unlockPool\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"poolApprove\", [tracksTransactions], Object.getOwnPropertyDescriptor(_class.prototype, \"poolApprove\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"claimRewardEx\", [tracksTransactions], Object.getOwnPropertyDescriptor(_class.prototype, \"claimRewardEx\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"claimRewardHiRisk\", [tracksTransactions], Object.getOwnPropertyDescriptor(_class.prototype, \"claimRewardHiRisk\"), _class.prototype), _applyDecoratedDescriptor(_class.prototype, \"claimRewardLowRisk\", [tracksTransactions], Object.getOwnPropertyDescriptor(_class.prototype, \"claimRewardLowRisk\"), _class.prototype)), _class);\nexport { RewardService as default };\n;\n\n(function () {\n  var reactHotLoader = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.default : undefined;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(RewardService, \"RewardService\", \"/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/libs/dai-plugin-mcd/src/RewardService.js\");\n})();\n\n;\n\n(function () {\n  var leaveModule = typeof reactHotLoaderGlobal !== 'undefined' ? reactHotLoaderGlobal.leaveModule : undefined;\n  leaveModule && leaveModule(module);\n})();","map":{"version":3,"sources":["/Users/good/Documents/Good/GitHub/FL/fork/bsc-fl-cdp-portal/src/libs/dai-plugin-mcd/src/RewardService.js"],"names":["PublicService","ServiceRoles","BigNumber","tracksTransactions","ERC20TokenAbi","RewardService","name","REWARDS","SYSTEM_DATA","highRisk","get","getContract","promise","proxyActions","claimReward","getContractAddress","dsProxy","amount","gem","holder","stake","withdraw","scs","contract","getContractByAddressAndAbi","approve","address","getReward"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,SAASA,aAAT,QAA8B,yBAA9B;AACA,SAASC,YAAT,QAA6B,aAA7B;AACA,OAAOC,SAAP,MAAsB,cAAtB;AACA,OAAOC,kBAAP,MAA+B,4BAA/B;AACA,OAAOC,aAAP,MAA0B,8BAA1B;IAEqBC,a;;;;;AACnB,2BAAyC;AAAA,QAA7BC,IAA6B,uEAAtBL,YAAY,CAACM,OAAS;;AAAA;;AAAA,6BACjCD,IADiC,EAC3B,CACV,eADU,EAEV,OAFU,EAGV,UAHU,EAIV,MAJU,EAKVL,YAAY,CAACO,WALH,CAD2B;AAQxC;;;;2BAUMC,Q,EAAU;AACf,aAAO,KAAKC,GAAL,CAAS,eAAT,EAA0BC,WAA1B,CACLF,QAAQ,GAAG,4BAAH,GAAkC,4BADrC,CAAP;AAGD;;;;;;;;;;AAGmBG,gBAAAA,O,QAAAA,O;iDACX,KAAKC,YAAL,CAAkBC,WAAlB,CACL,KAAKJ,GAAL,CAAS,eAAT,EAA0BK,kBAA1B,CAA6C,aAA7C,CADK,EAEL;AAAEC,kBAAAA,OAAO,EAAE,IAAX;AAAiBJ,kBAAAA,OAAO,EAAPA;AAAjB,iBAFK,C;;;;;;;;;;;;;;;;;;;iGAOMK,M,EAAQC,G,EAAKT,Q;;;;;;AAAYG,gBAAAA,O,SAAAA,O;kDAE/B,KAAKO,MAAL,CAAYV,QAAZ,EAAsBW,KAAtB,CAA4BH,MAA5B,EAAoCC,GAApC,EAAyC;AAC9CF,kBAAAA,OAAO,EAAE,KADqC;AAE9CJ,kBAAAA,OAAO,EAAPA;AAF8C,iBAAzC,C;;;;;;;;;;;;;;;;;;;mGAOQK,M,EAAQC,G,EAAKT,Q;;;;;;AAAYG,gBAAAA,O,SAAAA,O;kDAEjC,KAAKO,MAAL,CAAYV,QAAZ,EAAsBY,QAAtB,CAA+BJ,MAA/B,EAAuCC,GAAvC,EAA4C;AACjDF,kBAAAA,OAAO,EAAE,KADwC;AAEjDJ,kBAAAA,OAAO,EAAPA;AAFiD,iBAA5C,C;;;;;;;;;;;;;;;;;;;oGAOSK,M,EAAQC,G,EAAKT,Q;;;;;;AAAYG,gBAAAA,O,SAAAA,O;AACnCU,gBAAAA,G,GAAM,KAAKZ,GAAL,CAAS,eAAT,C;AACNa,gBAAAA,Q,GAAWD,GAAG,CAACE,0BAAJ,CAA+BN,GAA/B,EAAoCd,aAApC,C;kDACVmB,QAAQ,CAACE,OAAT,CAAiB,KAAKN,MAAL,CAAYV,QAAZ,EAAsBiB,OAAvC,EAAgD,CAAC,CAAjD,EAAoD;AACzDV,kBAAAA,OAAO,EAAE,KADgD;AAEzDJ,kBAAAA,OAAO,EAAPA;AAFyD,iBAApD,C;;;;;;;;;;;;;;;;;;;;;;;;;AAOaA,gBAAAA,O,SAAAA,O;kDACb,KAAKF,GAAL,CAAS,eAAT,EACJC,WADI,CACQ,sBADR,EAEJG,WAFI,CAEQ;AAAEE,kBAAAA,OAAO,EAAE,KAAX;AAAkBJ,kBAAAA,OAAO,EAAPA;AAAlB,iBAFR,C;;;;;;;;;;;;;;;;;;;;;;;;;AAMiBA,gBAAAA,O,SAAAA,O;kDACjB,KAAKF,GAAL,CAAS,eAAT,EACJC,WADI,CACQ,qBADR,EAEJgB,SAFI,CAEM;AAAEX,kBAAAA,OAAO,EAAE,KAAX;AAAkBJ,kBAAAA,OAAO,EAAPA;AAAlB,iBAFN,C;;;;;;;;;;;;;;;;;;;;;;;;;AAMkBA,gBAAAA,O,SAAAA,O;kDAClB,KAAKF,GAAL,CAAS,eAAT,EACJC,WADI,CACQ,qBADR,EAEJgB,SAFI,CAEM;AAAEX,kBAAAA,OAAO,EAAE,KAAX;AAAkBJ,kBAAAA,OAAO,EAAPA;AAAlB,iBAFN,C;;;;;;;;;;;;;;;;;;;;;;;;;wBAlEU;AACjB,aAAO,KAAKF,GAAL,CAAS,eAAT,EAA0BC,WAA1B,CAAsC,sBAAtC,CAAP;AACD;;;wBAEoB;AACnB,aAAO,KAAKD,GAAL,CAAS,eAAT,EAA0BC,WAA1B,CAAsC,4BAAtC,CAAP;AACD;;;;EAjBwCX,a,gEAyBxCG,kB,iJAQAA,kB,gJASAA,kB,mJASAA,kB,sJAUAA,kB,4JAOAA,kB,iKAOAA,kB;SA3EkBE,a;;;;;;;;;;0BAAAA,a","sourcesContent":["import { PublicService } from '@makerdao/services-core';\nimport { ServiceRoles } from './constants';\nimport BigNumber from 'bignumber.js';\nimport tracksTransactions from './utils/tracksTransactions';\nimport ERC20TokenAbi from '../contracts/abis/ERC20.json';\n\nexport default class RewardService extends PublicService {\n  constructor(name = ServiceRoles.REWARDS) {\n    super(name, [\n      'smartContract',\n      'proxy',\n      'accounts',\n      'web3',\n      ServiceRoles.SYSTEM_DATA\n    ]);\n  }\n\n  get proxyActions() {\n    return this.get('smartContract').getContract('PROXY_ACTIONS_REWARD');\n  }\n\n  get holderHighRisk() {\n    return this.get('smartContract').getContract('FL_REWARDER_GOV_USD_HOLDER');\n  }\n\n  holder(highRisk) {\n    return this.get('smartContract').getContract(\n      highRisk ? 'FL_REWARDER_GOV_USD_HOLDER' : 'FL_REWARDER_STABLES_HOLDER'\n    );\n  }\n\n  @tracksTransactions\n  async claimReward({ promise }) {\n    return this.proxyActions.claimReward(\n      this.get('smartContract').getContractAddress('FL_REWARDER'),\n      { dsProxy: true, promise }\n    );\n  }\n\n  @tracksTransactions\n  async lockPool(amount, gem, highRisk, { promise }) {\n    // stake(uint256 amount, address gem)\n    return this.holder(highRisk).stake(amount, gem, {\n      dsProxy: false,\n      promise\n    });\n  }\n\n  @tracksTransactions\n  async unlockPool(amount, gem, highRisk, { promise }) {\n    // function withdraw(uint256 amount, address gem)\n    return this.holder(highRisk).withdraw(amount, gem, {\n      dsProxy: false,\n      promise\n    });\n  }\n\n  @tracksTransactions\n  async poolApprove(amount, gem, highRisk, { promise }) {\n    const scs = this.get('smartContract');\n    const contract = scs.getContractByAddressAndAbi(gem, ERC20TokenAbi);\n    return contract.approve(this.holder(highRisk).address, -1, {\n      dsProxy: false,\n      promise\n    });\n  }\n\n  @tracksTransactions\n  async claimRewardEx({ promise }) {\n    return this.get('smartContract')\n      .getContract('FL_REWARD_AGGREGATOR')\n      .claimReward({ dsProxy: false, promise });\n  }\n\n  @tracksTransactions\n  async claimRewardHiRisk({ promise }) {\n    return this.get('smartContract')\n      .getContract('FL_REWARDER_GOV_USD')\n      .getReward({ dsProxy: false, promise });\n  }\n\n  @tracksTransactions\n  async claimRewardLowRisk({ promise }) {\n    return this.get('smartContract')\n      .getContract('FL_REWARDER_STABLES')\n      .getReward({ dsProxy: false, promise });\n  }\n\n}\n"]},"metadata":{},"sourceType":"module"}